# ==================== APPLICATION ====================
app.frontend.url=https://client-hub-portal.vercel.app
upload.allowed.types=image/jpeg,image/png,image/webp
upload.max.file.size=5MB
APP_DEBUG=false

# ==================== SERVER ====================
server.port=8080
server.servlet.encoding.charset=UTF-8
server.servlet.encoding.enabled=true
server.compression.enabled=true
server.compression.mime-types=application/json,application/xml,text/html,text/xml,text/plain,application/javascript,text/css

# ==================== SPRING ====================
spring.application.name=E-Commerce
spring.cache.type=caffeine
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB
spring.servlet.multipart.enabled=true

# ==================== DATABASE (SUPABASE POSTGRESQL) ====================
spring.datasource.url=${DATABASE_URL}?sslmode=require&prepareThreshold=0&preparedStatementCacheQueries=0
spring.datasource.username=${DATABASE_USERNAME}
spring.datasource.password=${DATABASE_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

# HikariCP Connection Pool Configuration (Optimized for Supabase)
spring.datasource.hikari.auto-commit=false
spring.datasource.hikari.connection-timeout=60000
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=600000
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=1
spring.datasource.hikari.pool-name=HikariCP-Supabase
spring.datasource.hikari.connection-test-query=SELECT 1
spring.datasource.hikari.leak-detection-threshold=60000
spring.datasource.hikari.initialization-fail-timeout=-1

# ==================== JPA / HIBERNATE ====================
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.open-in-view=false
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.enable_lazy_load_no_trans=false
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.use_sql_comments=false
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.jdbc.fetch_size=100
spring.jpa.properties.hibernate.default_batch_fetch_size=16
spring.jpa.properties.hibernate.generate_statistics=false
spring.jpa.properties.hibernate.cache.use_second_level_cache=false
spring.jpa.properties.hibernate.cache.use_query_cache=false

# ==================== MAILJET EMAIL (PREFERRED - HTTP API) ====================
# Mailjet HTTP API Configuration (Primary method)
miljet.api.key=${MILJET_API_KEY:}
miljet.api.url=${MILJET_API_URL:https://api.mailjet.com/v3.1/send}

# ==================== SMTP EMAIL (FALLBACK) ====================
# SMTP Configuration for Mailjet (Fallback when HTTP API is not configured)
spring.mail.host=${MAILJET_SMTP_HOST:in-v3.mailjet.com}
spring.mail.port=${MAILJET_SMTP_PORT:587}
spring.mail.username=${MAILJET_API_KEY}
spring.mail.password=${MAILJET_SECRET_KEY}
spring.mail.protocol=smtp
spring.mail.default-encoding=UTF-8
spring.mail.from=${MAIL_SENDER_EMAIL:hloniyacho@gmail.com}

# SMTP Properties (STARTTLS for Port 587)
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.ssl.trust=${MAILJET_SMTP_HOST:in-v3.mailjet.com}
spring.mail.properties.mail.smtp.connectiontimeout=10000
spring.mail.properties.mail.smtp.timeout=10000
spring.mail.properties.mail.smtp.writetimeout=10000
spring.mail.properties.mail.debug=true

# Email Sender Information
mail.sender.email=${MAIL_SENDER_EMAIL:hloniyacho@gmail.com}
mail.sender.name=${MAIL_SENDER_NAME:E-Commerce Store}

# ==================== SECURITY ====================
# JWT Configuration
security.jwt.secret=${JWT_SECRET}
security.jwt.expirationMillis=900000
security.jwt.refreshExpirationMillis=604800000

# Rate Limiting
security.rate-limit.loginAttempts=5
security.rate-limit.loginWindowMinutes=15
security.rate-limit.retryAfterSeconds=900

# CORS Configuration (Additional to CorsConfig.java)
app.cors.allowed-origins=${APP_CORS_ALLOWED_ORIGINS:https://client-hub-portal.vercel.app,http://localhost:5173,http://localhost:3000}

# ==================== SUPABASE STORAGE ====================
supabase.url=${SUPABASE_URL}
supabase.service.key=${SUPABASE_SERVICE_KEY}
supabase.anon.key=${SUPABASE_ANON_KEY}

# Supabase Storage Buckets
supabase.bucket.product.images=${SUPABASE_PRODUCT_BUCKET:product-images}
supabase.bucket.review.images=${SUPABASE_REVIEW_BUCKET:review-images}
supabase.bucket.category.images=${SUPABASE_CATEGORY_BUCKET:category-images}

# ==================== CACHING ====================
# Caffeine Cache Configuration
spring.cache.caffeine.spec=maximumSize=1000,expireAfterWrite=10m

# ==================== ACTUATOR / MONITORING ====================
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoints.web.base-path=/actuator
management.endpoint.health.show-details=when_authorized
management.endpoint.health.probes.enabled=true
management.endpoint.metrics.enabled=true


# Health Check Configuration
management.health.db.enabled=true
management.health.diskspace.enabled=true

# ==================== LOGGING ====================
# Logging Levels
logging.level.root=INFO
logging.level.za.ac.styling=INFO
logging.level.org.springframework.web=INFO
logging.level.org.springframework.security=INFO
logging.level.org.hibernate.SQL=WARN
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=WARN
logging.level.com.zaxxer.hikari=INFO

# Logging Pattern
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# ==================== ERROR HANDLING ====================
server.error.include-message=always
server.error.include-binding-errors=always
server.error.include-stacktrace=on_param
server.error.include-exception=false

# ==================== JACKSON (JSON) ====================
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.serialization.fail-on-empty-beans=false
spring.jackson.deserialization.fail-on-unknown-properties=false

spring.jackson.date-format=yyyy-MM-dd'T'HH:mm:ss.SSS'Z'

# ==================== PROFILE ====================
spring.profiles.active=${SPRING_PROFILES_ACTIVE:production}

# ==================== MAILJET TEMPLATES (OPTIONAL) ====================
# If you're using Mailjet templates
mailjet.templates.welcome=${MAILJET_WELCOME_TEMPLATE_ID:}
mailjet.templates.password-reset=${MAILJET_PASSWORD_RESET_TEMPLATE_ID:}
mailjet.templates.order-confirmation=${MAILJET_ORDER_CONFIRMATION_TEMPLATE_ID:}

# ==================== PASSWORD RESET ====================
# Password reset token configuration
password.reset.token.expiry.hours=1
password.reset.otp.length=6

# ==================== INVENTORY ====================
# Inventory management settings
inventory.low-stock.alert.enabled=true
inventory.low-stock.threshold=5
inventory.reorder.auto-notify=true

# ==================== ORDER ====================
# Order processing settings
order.auto-confirm.enabled=false
order.invoice.auto-send=true
order.cancellation.window.hours=24

# ==================== SESSION ====================
server.servlet.session.timeout=30m
server.servlet.session.cookie.http-only=true
server.servlet.session.cookie.secure=true
server.servlet.session.cookie.same-site=none

# ==================== ASYNC ====================
spring.task.execution.pool.core-size=5
spring.task.execution.pool.max-size=10
spring.task.execution.pool.queue-capacity=100
spring.task.execution.thread-name-prefix=async-task-

# ==================== TIMEZONE ====================
spring.jpa.properties.hibernate.jdbc.time_zone=UTC
spring.jackson.time-zone=UTC