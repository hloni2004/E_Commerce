# ===============================
# DATABASE CONFIGURATION (Supabase)
# ===============================
# CRITICAL: Use Transaction Pooler (port 6543) for Spring Boot in production
spring.datasource.url=jdbc:postgresql://${DATABASE_HOST}:${DATABASE_PORT}/${DATABASE_NAME}?sslmode=require&prepareThreshold=0&pgbouncer=true

# Alternative: If DATABASE_HOST/PORT not available, use full URL
# spring.datasource.url=jdbc:postgresql://aws-1-eu-west-1.pooler.supabase.com:6543/postgres?sslmode=require&prepareThreshold=0&pgbouncer=true

# Fallback: Session Pooler (if transaction pooler has issues)
# spring.datasource.url=jdbc:postgresql://aws-1-eu-west-1.pooler.supabase.com:5432/postgres?sslmode=require

spring.datasource.username=postgres.widewqtjdgbphbksxpco
spring.datasource.password=${DATABASE_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

# ===============================
# JPA/HIBERNATE CONFIGURATION
# ===============================
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.jdbc.time_zone=UTC
spring.jpa.open-in-view=false

# ===============================
# HIKARICP CONNECTION POOL
# ===============================
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.leak-detection-threshold=60000

# ===============================
# SERVER CONFIGURATION
# ===============================
server.port=8080
server.error.include-message=always
server.error.include-stacktrace=on_param

# ===============================
# SPRING PROFILE
# ===============================
spring.profiles.active=${SPRING_PROFILES_ACTIVE:production}

# ===============================
# JWT CONFIGURATION
# ===============================
security.jwt.secret=${JWT_SECRET}
security.jwt.expirationMillis=900000
security.jwt.refreshExpirationMillis=604800000

# ===============================
# MAILJET CONFIGURATION
# ===============================
miljet.api.key=${MILJET_API_KEY}
miljet.api.url=${MILJET_API_URL:https://api.mailjet.com/v3.1/send}

# SMTP Settings (Fallback)
spring.mail.host=${MAILJET_SMTP_HOST:in-v3.mailjet.com}
spring.mail.port=${MAILJET_SMTP_PORT:587}
spring.mail.username=${MAIL_SENDER_EMAIL}
spring.mail.password=${MAILJET_API_KEY}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.connectiontimeout=5000
spring.mail.properties.mail.smtp.timeout=5000
spring.mail.properties.mail.smtp.writetimeout=5000
spring.mail.from=${MAIL_SENDER_EMAIL}

# ===============================
# SUPABASE CONFIGURATION
# ===============================
supabase.url=${SUPABASE_URL}
supabase.anon-key=${SUPABASE_ANON_KEY}
supabase.service.key=${SUPABASE_SERVICE_KEY}
supabase.bucket.product.images=product-images
supabase.bucket.review.images=review-images
supabase.bucket.category.images=category-images

# ===============================
# FILE UPLOAD CONFIGURATION
# ===============================
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=20MB

# ===============================
# LOGGING CONFIGURATION
# ===============================
logging.level.root=INFO
logging.level.za.ac.styling=DEBUG
logging.level.org.springframework.web=INFO
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
logging.level.com.zaxxer.hikari=DEBUG

# ===============================
# CORS CONFIGURATION
# ===============================
app.cors.allowed-origins=${APP_CORS_ALLOWED_ORIGINS:https://client-hub-portal.vercel.app,http://localhost:5173,http://localhost:3000}
app.frontend.url=${APP_FRONTEND_URL:https://client-hub-portal.vercel.app}

# ===============================
# DEBUG MODE
# ===============================
APP_DEBUG=${APP_DEBUG:false}
